#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# Check if there are any staged TypeScript files
STAGED_TS_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(ts|tsx)$')

if [ -n "$STAGED_TS_FILES" ]; then
    echo "🔍 Running linter on staged files..."
    npm run lint
    
    echo "🎨 Running prettier on staged files..."
    npm run format
    
    echo "📝 Re-staging formatted files..."
    git add $STAGED_TS_FILES
fi

echo "🔨 Building project to ensure it compiles..."
npm run build
